
<div>

<div class="modal-dialog">
    <form class="modal-content" action="" method="post">
        <div class="modal-header">
            <h5 class="modal-title" id="addNewModalLabel">Add new prescription</h5>
            <button type="button" class="btn-close" (click)="close()" aria-label="Close"></button>
        </div>
        <div class="modal-body">            

                <div class="mb-3 d-inline-flex align-items-center">
                    <label class="mx-2 form-label" for="no-of-items">No. of Item(s) Ordered</label>
                    <input [(ngModel)]="itemsOrdered" class="form-control" required min="1" style="width: 150px;" type="number"
                        name="number-of-items" id="number-of-items" onclick="this.select()">
                    <div class="invalid-feedback">This field is required</div>
                </div> <!-- Number of items ordered -->

                <div class="mb-3 d-inline-flex align-items-center">
                    <label class="mx-2 form-label" for="no-of-items">No. O/S (unsubstitutable)</label>
                    <input [ngModel]="itemsUsubstitutable" (ngModelChange)="itemsUsubstitutable=$event" class="form-control" required min="1" style="width: 150px;" type="number"
                        name="number-of-items" id="number-of-items" onclick="this.select()">
                    <div class="invalid-feedback">This field is required</div>
                </div> <!-- Number of items missing -->
        
                <p class="mb-3">List O/S items, subsituted or not (if any): </p>
        
                <table class="table table-striped bg-light">
                    <tr>
                        <th>#</th>
                        <th>Generic Description</th>
                        <th>BrandName</th>
                        <th></th>
                    </tr>
                    @for (os of osList; track $index) {
                        
                        <tr>
                            <td>{{$index + 1}}</td>
                            <td class="text-wrap" style="width: 300px;">{{os.GenericDescription}}</td>
                            <td>{{os.BrandName ? os.BrandName : "Generic"}}</td>
                            <td><i title="Remove Row" role="banner" (click)="osList.splice($index,1)" id="deleteOs" class="bi bi-trash"></i></td>
                        </tr>
                    }
        
        
                </table> <!-- table of out of stock -->        
                <div class="dropdown">
                    <input  class="dropdown-toggle form-control" style="width: 50%;" data-bs-toggle="dropdown"
                        autocomplete="false" placeholder="search and select os item ..."><!-- Dropdown filter-->
                        <ul class="dropdown-menu" style="width:100%;height: 300px;overflow:auto;" aria-expanded="false">
                            @if (inventory$ |async) {
                                @for (item of inventory$ |async; track $index) {

                                    <li class="dropdown-item " role="button" (click)="osList.push(item)">
                                        <a>
                                            <span class="text-wrap" >{{item.Code + ' ' + item.GenericDescription}}</span> 
                                            <span >{{item.BrandName ? " " + item.BrandName : ""}}</span> 
                                        </a>
                                    </li>                                                 
                                }

                            }
                            @else {

                                
                                <li class="ps-2"> <!-- x-show="search!='' && !filteredInventory.length"-->
                                    <span class="fw-bold" ></span> <!-- x-text="search + ' '"--> does not exist.
                                    <a href="https://docs.google.com/spreadsheets/d/1RX0Zz_9LkdIv5R2VeRfg0NnELdcWWF3Nad9QtCH9gAc/edit#gid=0"
                                        target="_blank">
                                        Click to add
                                    </a>, then Refresh inventory.
                                </li>
                            }
                            
                        
                        
                    </ul><!-- Dropdown Menu -->
                </div><!--Dropdown-->                
            
            
        </div>
        <div class="modal-footer">
            <button type="button" (click)="save($event)" class="btn btn-primary">Save New Prescription</button>
        </div>
    </form>
</div>



    <div class="app-modal-backdrop"></div>
</div>